(()=>{"use strict";function t(t=0){let n=t,e=0,o=[];return{length:()=>n,hit:function(t){for(const a of o)if(r=t,(n=a.coord)[0]==r[0]&&n[1]==r[1]&&!a.hit)return a.hit=!0,e++,!0;var n,r;return!1},getHits:()=>e,itSunk:function(){return e>=n},addCoord:function(t){const n={coord:t,hit:!1};o.push(n)}}}function n(n=10,e=10){const o=n,r=n;let a=0;const i=function(t,n){const e=new Array(t);for(let o=0;o<t;o++)e[o]=new Array(n).fill(0);return e}(o,r);function l(t,n=1,e="V"){if("V"==e){const e=t[0],r=t[0]+n;for(let n=e;n<r;n++)if(n>=o||i[n][t[1]])return!1}else if("H"==e){const e=t[1],o=t[1]+n;for(let n=e;n<o;n++)if(n>=r||i[t[0]][n])return!1}return!0}return{shipsAvailable:()=>a>0,available:l,addShip:function(n,e=1,o="H"){if(l(n,e,o)){const r=new t(e);if("V"==o){const t=n[0],o=n[0]+e;for(let e=t;e<o;e++)i[e][n[1]]=r,r.addCoord([e,n[1]])}else if("H"==o){const t=n[1],o=n[1]+e;for(let e=t;e<o;e++)i[n[0]][e]=r,r.addCoord([n[0],e])}a++}},getShip:function(t){return i[t[0]][t[1]]},receiveAttack:function(t){const n=i[t[0]][t[1]];let e=!1;return 0!==n&&n.hit(t)&&(e=!0,n.itSunk()&&a--),e},shipCount:a}}function e(t="",e=!1){let o=t,r=new n;const a=e,i=[];return{getName:()=>o,getBoard:()=>r,randomPlay:function(){let t=0,n=0;do{t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random())}while(i.find((e=>e[0]==t&&e[1]==n))&&i.length<100);return i.push([t,n]),r.receiveAttack([t,n])},isArtificial:()=>a,setName:t=>{o=t},randomBuild:function(){let t=0,n=0,e="H";for(let o=4;o>1;o--){do{t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random()),e=Math.floor(8*Math.random())%2==0?"V":"H"}while(!r.available([t,n],o,e));r.addShip([t,n],o,e)}},lastPlay:()=>i[i.length-1]}}function o(){let t={},n={},o={};const r=()=>{o=o===t?n:t};return{init:function(r="Player 1",a="Player 2"){t=new e(r),n=new e(a),t.randomBuild(),n.randomBuild(),o=t},switchPlayer:r,play:function(t){return r(),!!o.getBoard().receiveAttack(t)},getCurrentPlayer:()=>o.getName(),autoPlay:function(){return r(),o.randomPlay()},getLastPlay:function(){return o.lastPlay()},getPlayer1:function(){return t}}}const r=t=>document.getElementById(t),a=(t,n)=>{const e=document.createElement(t);return null!=n&&r(n).append(e),e};(new function(){const t=new o;function n(n,o=!1){for(let r=0;r<10;r++){const i=a("div",n);i.classList.add("row");for(let l=0;l<10;l++){const c=a("div");c.classList.add("box"),c.id=`${n}-r${r}-c${l}`,o?t.getPlayer1().getBoard().available([r,l])||c.classList.add("ship"):e(c,r,l),i.append(c)}}}function e(n,e,o){n.addEventListener("click",(()=>{if("box"==n.className){i(n,t.play([e,o]));const l=t.autoPlay();i((a=t.getLastPlay(),r(`board-one-r${a[0]}-c${a[1]}`)),l)}var a}))}function i(t,n){n?t.classList.add("hit"):t.classList.add("fail")}return{init:function(){t.init(),n("board-two"),n("board-one",!0),r("btn").addEventListener("click",(()=>{const n=r("input-one").value;var e;t.init(n),e=n,r("name-one").textContent=e}))}}}).init()})();